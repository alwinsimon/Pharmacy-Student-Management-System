// src/constants/permissions.constants.js
/**
 * Permission definitions for the system
 * Used for fine-grained access control
 */
const RESOURCE_TYPES = {
  USER: 'user',
  DEPARTMENT: 'department',
  CASE: 'case',
  DOCUMENT: 'document',
  LOG: 'activity_log',
  SETTING: 'system_setting',
  REPORT: 'report'
};

const ACTIONS = {
  CREATE: 'create',
  READ: 'read',
  UPDATE: 'update',
  DELETE: 'delete',
  MANAGE: 'manage',
  APPROVE: 'approve',
  REVIEW: 'review',
  SUBMIT: 'submit',
  EXPORT: 'export',
  IMPORT: 'import',
  ASSIGN: 'assign'
};

// Permission format: resource_action
const PERMISSIONS = {
  // User permissions
  USER_CREATE: `${RESOURCE_TYPES.USER}_${ACTIONS.CREATE}`,
  USER_READ: `${RESOURCE_TYPES.USER}_${ACTIONS.READ}`,
  USER_UPDATE: `${RESOURCE_TYPES.USER}_${ACTIONS.UPDATE}`,
  USER_DELETE: `${RESOURCE_TYPES.USER}_${ACTIONS.DELETE}`,
  USER_MANAGE: `${RESOURCE_TYPES.USER}_${ACTIONS.MANAGE}`,
  USER_APPROVE: `${RESOURCE_TYPES.USER}_${ACTIONS.APPROVE}`,
  
  // Department permissions
  DEPARTMENT_CREATE: `${RESOURCE_TYPES.DEPARTMENT}_${ACTIONS.CREATE}`,
  DEPARTMENT_READ: `${RESOURCE_TYPES.DEPARTMENT}_${ACTIONS.READ}`,
  DEPARTMENT_UPDATE: `${RESOURCE_TYPES.DEPARTMENT}_${ACTIONS.UPDATE}`,
  DEPARTMENT_DELETE: `${RESOURCE_TYPES.DEPARTMENT}_${ACTIONS.DELETE}`,
  DEPARTMENT_MANAGE: `${RESOURCE_TYPES.DEPARTMENT}_${ACTIONS.MANAGE}`,
  
  // Case permissions
  CASE_CREATE: `${RESOURCE_TYPES.CASE}_${ACTIONS.CREATE}`,
  CASE_READ: `${RESOURCE_TYPES.CASE}_${ACTIONS.READ}`,
  CASE_UPDATE: `${RESOURCE_TYPES.CASE}_${ACTIONS.UPDATE}`,
  CASE_DELETE: `${RESOURCE_TYPES.CASE}_${ACTIONS.DELETE}`,
  CASE_SUBMIT: `${RESOURCE_TYPES.CASE}_${ACTIONS.SUBMIT}`,
  CASE_REVIEW: `${RESOURCE_TYPES.CASE}_${ACTIONS.REVIEW}`,
  CASE_ASSIGN: `${RESOURCE_TYPES.CASE}_${ACTIONS.ASSIGN}`,
  
  // Document permissions
  DOCUMENT_CREATE: `${RESOURCE_TYPES.DOCUMENT}_${ACTIONS.CREATE}`,
  DOCUMENT_READ: `${RESOURCE_TYPES.DOCUMENT}_${ACTIONS.READ}`,
  DOCUMENT_UPDATE: `${RESOURCE_TYPES.DOCUMENT}_${ACTIONS.UPDATE}`,
  DOCUMENT_DELETE: `${RESOURCE_TYPES.DOCUMENT}_${ACTIONS.DELETE}`,
  DOCUMENT_EXPORT: `${RESOURCE_TYPES.DOCUMENT}_${ACTIONS.EXPORT}`,
  DOCUMENT_IMPORT: `${RESOURCE_TYPES.DOCUMENT}_${ACTIONS.IMPORT}`,
  
  // Log permissions
  LOG_READ: `${RESOURCE_TYPES.LOG}_${ACTIONS.READ}`,
  LOG_EXPORT: `${RESOURCE_TYPES.LOG}_${ACTIONS.EXPORT}`,
  
  // Setting permissions
  SETTING_READ: `${RESOURCE_TYPES.SETTING}_${ACTIONS.READ}`,
  SETTING_UPDATE: `${RESOURCE_TYPES.SETTING}_${ACTIONS.UPDATE}`,
  
  // Report permissions
  REPORT_CREATE: `${RESOURCE_TYPES.REPORT}_${ACTIONS.CREATE}`,
  REPORT_READ: `${RESOURCE_TYPES.REPORT}_${ACTIONS.READ}`,
  REPORT_EXPORT: `${RESOURCE_TYPES.REPORT}_${ACTIONS.EXPORT}`
};

// Role-based permission assignments
const ROLE_PERMISSIONS = {
  [require('./roles.constants').ROLES.SUPER_ADMIN]: Object.values(PERMISSIONS),
  [require('./roles.constants').ROLES.MANAGER]: [
    // User permissions (limited)
    PERMISSIONS.USER_READ,
    PERMISSIONS.USER_UPDATE,
    PERMISSIONS.USER_APPROVE,
    
    // Department permissions
    PERMISSIONS.DEPARTMENT_READ,
    PERMISSIONS.DEPARTMENT_UPDATE,
    
    // Full case management
    PERMISSIONS.CASE_CREATE,
    PERMISSIONS.CASE_READ,
    PERMISSIONS.CASE_UPDATE,
    PERMISSIONS.CASE_ASSIGN,
    PERMISSIONS.CASE_REVIEW,
    
    // Document management
    PERMISSIONS.DOCUMENT_CREATE,
    PERMISSIONS.DOCUMENT_READ,
    PERMISSIONS.DOCUMENT_UPDATE,
    PERMISSIONS.DOCUMENT_EXPORT,
    PERMISSIONS.DOCUMENT_IMPORT,
    
    // Logs and reports
    PERMISSIONS.LOG_READ,
    PERMISSIONS.REPORT_CREATE,
    PERMISSIONS.REPORT_READ,
    PERMISSIONS.REPORT_EXPORT,
    
    // Settings (limited)
    PERMISSIONS.SETTING_READ
  ],
  [require('./roles.constants').ROLES.STAFF]: [
    // Limited user management
    PERMISSIONS.USER_READ,
    
    // Department read
    PERMISSIONS.DEPARTMENT_READ,
    
    // Case management (no delete)
    PERMISSIONS.CASE_CREATE,
    PERMISSIONS.CASE_READ,
    PERMISSIONS.CASE_UPDATE,
    PERMISSIONS.CASE_REVIEW,
    
    // Document management (no delete)
    PERMISSIONS.DOCUMENT_CREATE,
    PERMISSIONS.DOCUMENT_READ,
    PERMISSIONS.DOCUMENT_UPDATE,
    PERMISSIONS.DOCUMENT_EXPORT,
    
    // Reports
    PERMISSIONS.REPORT_CREATE,
    PERMISSIONS.REPORT_READ,
    PERMISSIONS.REPORT_EXPORT
  ],
  [require('./roles.constants').ROLES.STUDENT]: [
    // Self-management only
    PERMISSIONS.USER_READ,
    
    // Limited case access
    PERMISSIONS.CASE_CREATE,
    PERMISSIONS.CASE_READ,
    PERMISSIONS.CASE_SUBMIT,
    
    // Limited document access
    PERMISSIONS.DOCUMENT_READ,
    PERMISSIONS.DOCUMENT_CREATE,
    
    // Report access (only own)
    PERMISSIONS.REPORT_READ
  ]
};

module.exports = {
  RESOURCE_TYPES,
  ACTIONS,
  PERMISSIONS,
  ROLE_PERMISSIONS
};